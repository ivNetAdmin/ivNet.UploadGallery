$(document).ready(function() {

    if (window.location.href.lastIndexOf("?") == -1) {     
        gallery = "random";
    } else {

        var gallery = (window.location.href.substr(window.location.href.lastIndexOf("?") + 1));
    }

    $.ajax({
        url: '/api/gallery/list/' + gallery,
        type: 'GET',
        dataType: 'json',
        success: function(data) {
            var active = " active";

            var carousel = $('div.carousel-inner');
            var indicators = $('ol.carousel-indicators');

            $.each(data, function(index, value) {

                var rootDiv = $('<div/>', {
                    'class': 'item' + active
                }).appendTo(carousel);

                var galleryName = value.Gallery;
                //var plot = value.Plot.length >0 ? "Plot: " + value.Plot : "";
                var photoBy = value.Photographer.length > 0 ? "PhotoBy: " + value.Photographer : "";

                $('<h4/>', { 'html': galleryName  + " " + photoBy }).appendTo(rootDiv);

                $('<img/>', {
                    'alt': 'carousel image',
                    'src': value.Url
                }).appendTo(rootDiv);

                var captionDiv = $('<div/>', { 'class': 'carousel-caption' }).appendTo(rootDiv);

                // $('<h4/>', { 'html': unescape(value.Photographer) }).appendTo(captionDiv);

                $('<p/>', { 'html': unescape(value.Description) }).appendTo(captionDiv);


                $('<li/>', {
                    'data-target': '#listingCarousel',
                    'data-slide-to': index,
                    'class': active
                }).appendTo(indicators);

                active = "";

            });

            $("#listingCarousel").carousel();
        },
        error: function(x, y, z) {
            alert(x + '\n' + y + '\n' + z);
        }
    });
});
