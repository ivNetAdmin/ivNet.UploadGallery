//get file size
function GetFileSize(fileid) {
    try {
        var fileSize = 0;
        //for IE
        if (navigator.appVersion.indexOf("MSIE") !== -1) {
            //before making an object of ActiveXObject, 
            //please make sure ActiveX is enabled in your IE browser
            var objFSO = new ActiveXObject("Scripting.FileSystemObject");
            var filePath = $("#" + fileid)[0].value;
            var objFile = objFSO.getFile(filePath);
            var fileSize = objFile.size; //size in kb
            fileSize = fileSize / 1048576; //size in mb 
        }
            //for FF, Safari, Opeara and Others
        else {
            fileSize = $("#" + fileid)[0].files[0].size //size in kb
            fileSize = fileSize / 1048576; //size in mb 
        }
        return fileSize;
    }
    catch (e) {
        alert("Error is :" + e);
    }
};

//get file path from client system
function getNameFromPath(strFilepath) {
    var objRE = new RegExp(/([^\/\\]+)$/);
    var strName = objRE.exec(strFilepath);

    if (strName == null) {
        return null;
    }
    else {
        return strName[0];
    }
};

function checkfile() {
    var file = getNameFromPath($("#fileToUpload").val());;
    if (file != null) {
        var extension = file.substr((file.lastIndexOf('.') + 1));
        // alert(extension);
        switch (extension.toLowerCase()) {
            case 'jpg':
            case 'png':
           // case 'gif':
           // case 'pdf':
                flag = true;
                break;
            default:
                flag = false;
        }
    }
    if (flag == false) {
        $('#fileToUpload').parent().find('p').html("You can upload only jpg or png extension file");
        return false;
    }
    else {
        var size = GetFileSize('fileToUpload');
        if (size > 4) {
            $('#fileToUpload').parent().find('p').html("You can only upload a file up to 4 MB in size");
            return false;
        }       
    }
};

$(function () {
    $("#fileToUpload").change(function () {
        $('p').html("");
        checkfile();
        return false;
    });

    $('body').find('input[type="submit"]').bind('click', function (e) {
        e.preventDefault();
        $('p').html("");
        if ($(this).attr('Name') == "AddNewGallery") {
            if ($('#gallery').val() == "") {
                $('#gallery').parent().find('p').html("Please provide a gallery name");
                return false;
            }            
        }
        else if ($(this).attr('Name') == "UploadImage") {
            if ($('#fileToUpload').val() == "") {
                $('#fileToUpload').parent().find('p').html("Please upload file");
                return false;
            }
        }
        $('form').submit();
    });

});